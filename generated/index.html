<html>
<head>
	<style>
		.footer {
			font-weight: 600;
			position: absolute; 
			bottom: 10;
			width: 99%;
		}
		.footer-right {
			width: 80%;
			text-align: right;
			display: inline-block;
		}
		.footer-row > a {
			text-decoration: none;
			font-weight: 600;
		}
		.footer-row > a > img,
		.footer-right > a > img {
			vertical-align: middle;
		}
		.footer-row > a > img {
			margin-right: 10px;
		}
		.row {
			width: 100%;
			text-align: center;
		}
	</style>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-46332195-2"></script>
	<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());

	gtag('config', 'UA-46332195-2');
	</script>

	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-KBPRS9Q');</script>
	<!-- End Google Tag Manager -->
</head>

<body onLoad="init()">
	<a href="https://www.icgc.cat" target="_blank"><img src="220px-ICGC.svg.png" alt="Logo ICGC" height="90" width="220"></a>
	<div id="filePresent">
		<h3>Fes click
			<a id="downloadLink" href="" target="_blank" >aquí</a>
			per descarregar el fitxer
		</h3>
		<div class="row">
			<img id="gif" src="" alt="Imatge" height="512" width="512">
		</div>
	</div>
	<div id="fileNotPresent">
		<h3>El fitxer no es pot descarregar</h3>
		<h5>Hem enviat un avís per veure que ha passat. Disculpa les molèsties</h5>
	</div>
    <script>

		function init(){

			var filePresent = document.querySelector("#filePresent");
			var fileNotPresent = document.querySelector("#fileNotPresent");
			var gif = document.querySelector("#gif");
			var downloadLink = document.querySelector("#downloadLink");

			var filePos = window.location.href.indexOf('?');
			var _file = window.location.href.slice(filePos + 1);
			if(filePos !== -1) {

				var urlFile = 'https://betaserver2.icgc.cat/wms2gif/generated/' + _file;

				filePresent.style.display = "block";
				fileNotPresent.style.display = "none";
				downloadLink.setAttribute("href", urlFile);
				gif.setAttribute("src", urlFile);
				ga('send', 'event', 'gificador', 'done_download', _file, 1);

			}else{

				filePresent.style.display = "none";
				fileNotPresent.style.display = "block";
				ga('send', 'event', 'gificador', 'error_download', _file, 1);

			}

		}

   </script>
</body>

</html>
